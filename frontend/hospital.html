<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>PrevAI – Hospital Dashboard</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Same CSS theme as index -->
  <link rel="stylesheet" href="css/home.css">
</head>

<body>

<!-- NAVBAR (UPDATED) -->
<nav class="navbar navbar-expand-lg bg-white border-bottom">
  <div class="container-fluid px-4">
    <a class="navbar-brand fw-bold text-dark" href="index.html">
      PrevAI – Disease Outbreak Early Warning
    </a>

    <a href="login.html" class="btn btn-outline-danger ms-auto">
      Logout
    </a>
  </div>
</nav>

<!-- MAIN CONTAINER -->
<div class="container my-5">

  <!-- PAGE TITLE -->
  <div class="mb-4">
    <h2 class="fw-semibold">Hospital Dashboard</h2>
    <p class="text-muted">
      Upload weekly disease case data to support early outbreak detection.
    </p>
  </div>

  <!-- WEEKLY UPLOAD REMINDER -->
  <div id="uploadWarning" class="alert alert-warning">
    Weekly data upload is recommended. Last submission was 8 days ago.
  </div>

  <!-- DASHBOARD BOXES -->
  <div class="row g-4">

    <!-- BOX 1: Instructions -->
    <div class="col-md-4">
      <div class="dashboard-box">
        <h5>Data Requirements</h5>
        <p class="small text-muted">
          Please upload hospital case data in CSV format with the following fields:
        </p>
        <p class="fw-semibold">
          Date | Region | Diagnosed_Disease | Reported_Cases
        </p>
      </div>
    </div>

    <!-- BOX 2: Upload -->
    <div class="col-md-4">
      <div class="dashboard-box">
        <h5>Weekly CSV Upload</h5>

        <form id="csvUploadForm">
          <input
            type="file"
            id="csvFile"
            class="form-control my-3"
            accept=".csv"
            required
          >

          <button type="submit" class="btn btn-success w-100">
            Upload CSV
          </button>
        </form>
      </div>
    </div>

    <!-- BOX 3: Status -->
    <div class="col-md-4">
      <div class="dashboard-box">
        <h5>Upload Status</h5>
        <div
          id="uploadStatus"
          class="status-box"
          aria-live="polite"
        >
          Awaiting upload...
        </div>
      </div>
    </div>

  </div>

  <!-- BOTTOM FULL-WIDTH BOX -->
  <div class="row mt-5">
    <div class="col-12">
      <div class="dashboard-box">
        <h5>Important Notes</h5>
        <ul class="text-muted small">
          <li>Upload data once per week.</li>
          <li>Ensure all case counts are verified.</li>
          <li>Incorrect data may affect outbreak predictions.</li>
          <li>Uploaded data is securely processed by health authorities.</li>
        </ul>
      </div>
    </div>
  </div>

</div>

<!-- SCRIPT -->
<script>
  // ===============================
  // Dummy data (frontend only)
  // ===============================
  let lastUploadDate = "2026-01-12"; // YYYY-MM-DD (dummy)

  function daysBetween(date1, date2) {
    const diffTime = Math.abs(date2 - date1);
    return Math.floor(diffTime / (1000 * 60 * 60 * 24));
  }

  function checkUploadReminder() {
    const warningBox = document.getElementById("uploadWarning");
    const lastDate = new Date(lastUploadDate + "T00:00:00");
    const today = new Date();

    const diffDays = daysBetween(lastDate, today);

    if (diffDays > 7) {
      warningBox.classList.remove("d-none");
      warningBox.innerText =
        `Data must be uploaded once every 7 days. Last submission was ${diffDays} days ago.`;
    } else {
      warningBox.classList.add("d-none");
    }
  }

  // Run on page load
  checkUploadReminder();

  // ===============================
  // CSV Upload (demo mode)
  // ===============================
  document.getElementById("csvUploadForm").addEventListener("submit", function(e) {
    e.preventDefault();

    document.getElementById("uploadStatus").innerText =
      "CSV uploaded successfully. Data sent for analysis.";

    // Update dummy upload date to today
    lastUploadDate = new Date().toISOString().split("T")[0];

    // Re-check reminder
    checkUploadReminder();
  });
</script>

</body>
</html>
